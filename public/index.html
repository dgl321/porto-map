<!DOCTYPE html>
<html lang="en" prefix="og: https://ogp.me/ns#">

<head>
  <meta charset="utf-8" />
  <!-- Prevent caching -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">

  <!-- Core meta tags -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#000000" />
  <meta name="description" content="Porto map of essential and important locations" />
  <meta name="application-name" content="Porto Map" />

  <!-- Favicons and manifest -->
  <link rel="icon" type="image/jpg" href="%PUBLIC_URL%/nata.jpg" sizes="192x192" />
  <link rel="apple-touch-icon" type="image/jpg" href="%PUBLIC_URL%/nata.jpg" sizes="192x192" />
  <link rel="image_src" href="https://porto-map.netlify.app/nata.jpg" />
  <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />

  <title>Porto Map</title>

  <!-- Critical Open Graph Tags - Combined for better performance -->
  <meta property="fb:app_id" content="956606658840308" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://porto-map.netlify.app/" />
  <meta property="og:title" content="Porto Map" />
  <meta property="og:description" content="Porto map of essential and important locations" />
  <meta property="og:image" content="https://porto-map.netlify.app/nata.jpg" />
  <meta property="og:image:url" content="https://porto-map.netlify.app/nata.jpg" />
  <meta property="og:image:secure_url" content="https://porto-map.netlify.app/nata.jpg" />
  <meta property="og:image:type" content="image/jpeg" />
  <meta property="og:image:width" content="612" />
  <meta property="og:image:height" content="612" />
  <meta property="og:image:alt" content="Porto Map" />
  <meta property="og:site_name" content="Porto Map" />

  <!-- Twitter Card - Minimal required tags -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:url" content="https://porto-map.netlify.app/" />
  <meta name="twitter:title" content="Porto Map" />
  <meta name="twitter:description" content="Porto map of essential and important locations" />
  <meta name="twitter:image" content="https://porto-map.netlify.app/nata.jpg" />

  <!-- Notion specific tags -->
  <meta name="notion:title" content="Porto Map" />
  <meta name="notion:image" content="https://porto-map.netlify.app/nata.jpg" />
  <meta name="notion:description" content="Porto map of essential and important locations" />

  <!-- Apple specific tags -->
  <meta name="apple-mobile-web-app-title" content="Porto Map" />
  <meta name="apple-mobile-web-app-capable" content="yes" />

  <!-- Single structured data block for search engines -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Porto Map",
      "description": "Porto map of essential and important locations",
      "url": "https://porto-map.netlify.app/",
      "image": "https://porto-map.netlify.app/nata.jpg"
    }
  </script>

  <!-- Fix Google Maps "Use two fingers" message -->
  <style>
    .gm-style>div>div:last-child>div:not(:empty) {
      display: none !important;
    }

    .dismissable-toaster {
      display: none !important;
    }

    .gm-style,
    .gm-style * {
      touch-action: manipulation !important;
    }
  </style>

  <!-- Combined JS for performance -->
  <script>
    // Set title and update parent frames
    document.title = "Porto Map";

    function updateParentFrameTitle() {
      if (window.parent && window.parent !== window) {
        try {
          window.parent.postMessage({
            type: 'metadata',
            title: 'Porto Map',
            description: 'Porto map of essential and important locations',
            image: 'https://porto-map.netlify.app/nata.jpg'
          }, '*');
        } catch (e) {
          console.error('Failed to send message to parent', e);
        }
      }
    }

    // Maps gesture handling
    window.gmapsGestureHandlingOverride = function () {
      if (window.google && window.google.maps && window.google.maps.Map && window.google.maps.Map.prototype) {
        const originalSetOptions = window.google.maps.Map.prototype.setOptions;
        window.google.maps.Map.prototype.setOptions = function (options) {
          if (!options) options = {};
          options.gestureHandling = 'greedy';
          return originalSetOptions.call(this, options);
        };
      }
    };

    // Combined event listener
    window.addEventListener('load', function () {
      // Update title in frames
      document.title = "Porto Map";
      updateParentFrameTitle();
      const titleInterval = setInterval(function () {
        document.title = "Porto Map";
        updateParentFrameTitle();
      }, 1000);
      setTimeout(function () { clearInterval(titleInterval); }, 10000);

      // Fix maps
      window.gmapsGestureHandlingOverride();
      const mapsInterval = setInterval(function () {
        window.gmapsGestureHandlingOverride();
        document.querySelectorAll('.gm-style > div > div:last-child > div').forEach(el => {
          if (el.textContent && el.textContent.includes('Use two fingers')) {
            el.style.display = 'none';
          }
        });
      }, 1000);
      setTimeout(function () { clearInterval(mapsInterval); }, 10000);
    });
  </script>
</head>

<body>
  <noscript>You need to enable JavaScript to run this app.</noscript>
  <div id="root"></div>
  <!--
      This HTML file is a template.
      If you open it directly in the browser, you will see an empty page.

      You can add webfonts, meta tags, or analytics to this file.
      The build step will place the bundled scripts into the <body> tag.

      To begin the development, run `npm start` or `yarn start`.
      To create a production bundle, use `npm run build` or `yarn build`.
    -->
</body>

</html>